<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>VIT-EASE</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style2.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <style>
        .posts {
            display: flex;
        }
    </style>
</head>
<body>
    <header>
        <div class="navbar">
            <div class="fixed-logo">
                <div class="nav-logo">
                    <div class="logo">
                        <img src="Screenshot 2024-04-09 165019.png" alt="Logo">
                    </div>
                </div>
                <div class="Title">
                    <p class="titles">VIT-EASE</p>
                </div>
            </div>
            <div class="options">
                <div class="option1">
                    <div class="icon"><a href="f_p1.html"><i class="fa-solid fa-comments i1"></i></a></div>
                    <div><a href="try1.html"><p class="opt1">Discussion</p></a></div>
                </div>
                <div class="option2">
                    <div class="icon"><a href="f_p2.html"><i class="fa-solid fa-book i3"></i></a></div>
                    <div><a href="page2.html"><p class="opt2">Curriculum</p></a></div>
                </div>
                <div class="option3">
                    <div class="icon"><a href="#"><i class="fa-solid fa-bullhorn i4"></i></a></div>
                    <div><a href="page3.html"><p class="opt3">Promo</p></a></div>
                </div>
                <div class="option5">
                    <div class="icon"><a href="#"><i class="fa-solid fa-hand"></i></a></div>
                    <div><a href="page3.html"><p class="opt3">Doubt</p></a></div>
                </div>
            </div>
            <div class="option4">
                <a href="#"><i class="fa-sharp fa-solid fa-user fa-2x"></i></a>
            </div>
        </div>
    </header>
    <div class="body">
        <div class="upper">
            <div class="left">
                <h2 class="msg">Hello!</h2>
            </div>
            <div class="right">
                <a href="#">
                    <span class="fil">Filter</span>
                    <i class="fa-solid fa-filter fa-1x if"></i>
                </a>
            </div>
        </div>
        <div class="posts" id="allposts">
            <!-- Posts will be dynamically added here -->
        </div>
        <div class="circle">
            <div class="plus">
                <a href="raise.html"><i class="fa-duotone fa-plus fa-2x iplus"></i></a>
            </div>
        </div>
    </div>

    <script src="script.js" async defer></script>
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            try {
                const response = await fetch("https://vit-ease.shivamkrthakur.in/api/v1/post/getAllPost", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                "postType":"discussion"
}),
                });

                const responseData = await response.json();
                console.log(responseData);
                if (responseData.status === 201) {
                    const posts = responseData.data.posts;
                    const parent = document.getElementById("allposts");

                    posts.forEach(post => {
                        const postCard = createPostCard(post);
                        parent.appendChild(postCard);
                    });
                } else {
                    console.log("Failed to fetch posts");
                }
            } catch (error) {
                console.error("An error occurred:", error);
            }
        });

        function createPostCard(post) {
            const postElement = document.createElement("div");
            postElement.classList.add("final");

            postElement.innerHTML = `
                <div class="discuss">
                    <div class="avatar">
                        <div class="ava">
                            <img src="Screenshot 2024-04-09 165019.png" alt="Avatar">
                        </div>
                        <div>
                            <p class="name">${post.display_name}</p>
                            <p class="id">22BRS1284</p>
                        </div>
                    </div>
                    <div class="code">
                        <b>${post.discussionType}</b>
                    </div>
                </div>
                <div class="content">
                    <p class="update">Update: ${post.heading}</p>
                    <p class="message">${post.description}</p>
                    <div class="block">
                        <div class="tag">
                            <b>${post.tags.join(', ')}</b>
                        </div>
                    </div>
                    <div class="reactions">
                        <div class="like">
                            <button class="but">
                                <i class="fa-solid fa-thumbs-up fa-2x ilike"></i>
                                <p class="number">${post.upvotes.length}</p>
                            </button>
                        </div>
                        <div class="comments">
                            <a href="#">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="-4 1 155 155" id="comment">
                                    <path fill="white" d="M25.784 21.017A10.992 10.992 0 0 0 27 16c0-6.065-4.935-11-11-11S5 9.935 5 16s4.935 11 11 11c1.742 0 3.468-.419 5.018-1.215l4.74 1.185a.996.996 0 0 0 .949-.263 1 1 0 0 0 .263-.95l-1.186-4.74zm-2.033.11.874 3.498-3.498-.875a1.006 1.006 0 0 0-.731.098A8.99 8.99 0 0 1 16 25c-4.963 0-9-4.038-9-9s4.037-9 9-9 9 4.038 9 9a8.997 8.997 0 0 1-1.151 4.395.995.995 0 0 0-.098.732z" class="sym"></path>
                                </svg>
                                <p class="type">Join Room</p>
                            </a>
                        </div>
                    </div>
                </div>
            `;
            return postElement;
        }
    </script>
</body>
</html>
